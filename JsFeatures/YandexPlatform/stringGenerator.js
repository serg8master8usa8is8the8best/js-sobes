/*
    Напишите функцию, которая будет возвращать комбинацию слов,
    для переданного массива массивов слов.
    Комбинации должны быть перечислены в порядке из примера.
    Если комбинации закончились, то функция возвращает `undefined`.
    При решении нельзя пользоваться генераторами.
*/

function allSequences(words) {
    // массив position хранит текущие индексы для каждого подмассива words
    // изначально все индексы = 0 (первые слова каждого массива)
    const position = new Array(words.length).fill(0);

    // флаг завершения перебора всех комбинаций
    let finished = false;

    // возвращаем функцию-генератор последовательностей
    return function nextSequence() {
        // если все комбинации перебраны - возвращаем undefined
        if (finished) return undefined;

        // 1. Формируем текущую комбинацию:
        // берем из каждого массива слово по текущему индексу и объединяем через пробел
        const current = position.map((val, i) => words[i][val]).join(" ");

        // 2. Переходим к следующей комбинации:
        // работаем как со счетчиком (как в одометре/арифмометре)
        // начинаем с последнего массива (младший разряд)
        for (let i = words.length - 1; i >= 0; i--) {
            // увеличиваем индекс текущего массива
            position[i]++;

            // если индекс не достиг предела длины массива - останавливаем перебор
            // это как когда в одометре цифра 0-8 -> 9, но не сбрасывается в 0
            if (position[i] < words[i].length) break;

            // иначе сбрасываем индекс в 0 (как переход 9 -> 0 с переносом)
            position[i] = 0;

            // если дошли до первого массива (старшего разряда) и его тоже нужно сбросить
            // значит все комбинации перебраны
            if (i === 0) {
                finished = true;
            }
        }

        // возвращаем сформированную до увеличения индексов комбинацию
        return current;
    };
}

const nextSequence = allSequences([
    [0, 1, 2],
    ["a", "b"],
    ["?", "!", "."],
]);

console.log(nextSequence()); // "0 a ?"
console.log(nextSequence()); // "0 a !"
console.log(nextSequence()); // "0 a ."
console.log(nextSequence()); // "0 b ?"
// ...
console.log(nextSequence()); // "2 b ."
console.log(nextSequence()); // undefined